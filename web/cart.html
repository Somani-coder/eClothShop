<!DOCTYPE html>
<html >

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
        <title> cart </title>
        <link href="style.css" rel="stylesheet" type="text/css" />
        <link href="https://fonts,googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    </head>


    <body>
        <div class="container">
            <div class="navbar">
                <div class="logo">
                    <img src="https://i.pinimg.com/564x/fd/83/c5/fd83c5d3c62594a851ecd31abf1109b9.jpg" width="125px">
                </div>
                <nav>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="products.html">Products</a></li>
                        <li><a href="about.html">About</a></li>
                        <li><a href="">Contact</a></li>
                        <li><a href="login.html">Account</a></li>
                    </ul>
                </nav>
                <li><a href="cart.html"> <img src="https://i.pinimgjcom/564x/9e/b3/1f/9eb31f1397aa013972c607f8d38923fd.jpg" width="30px" height="30px"></a></li>
                <li><a href="ordersection.html"><img src="https://w7.pngwing.com/pngs/813/633/png-transparent-burger-line-list-menu-nav-navigation-option-mobile-basic-icon-thumbnail.png"
                                    class="menu-icon"></a></li>
            </div>
        </div>
        <!----------- cart items details ------------->
        <div class="small-container cart-page">

            <table>
                <tr>
                    <th>product</th>
                    <th>Quantity</th>
                    <th>Size</th>
                    <th>Total</th>
                    <th>action</th>
                </tr>
                <tbody id="myTable">
                </tbody>

                <!--            <td>
                                <div class="cart-info">
                                    <img src="https://www.lee.in/media/catalog/product/l/m/lmts000184_2.jpg" width="125px">
                                    <div>
                                        <p>Red Printed T-shirt</p>
                                        <small>Price: ₹499</small>
                                        <br>
                                        <a href="">Remove</a>
                                    </div>
                                </div>
                            </td>
                            <td><input type="number" value="1"></td>
                            <td>₹499.00</td>-->

                <!--         <tr>
                            <td>
                                <div class="cart-info">
                                    <img src="https://rukminim1.flixcart.com/image/612/612/l55nekw0/shoe/c/0/l/12-dh3162-001nike-13-nike-black-white-original-imagfw7t6gnggebj.jpeg?q=70"width="125px">
                                    <div>
                                        <p>Nike-Original Black and White sneakers</p>
                                        <small>Price: ₹689</small>
                                        <br>
                                        <a href="">Remove</a>
                                    </div>
                                </div>
                            </td>
                            <td><input type="number" value="1"></td>
                            <td>₹499.00</td>
                        </tr>-->
            </table>

            <div class="total-price">
                <table id ="totalCartAmountTable">
                    <tr>
                        <td>Subtotal</td>
<!--                    <button type="button" onClick="updateCartDetail()">Click Me!</button>-->
                    </tr>

                    <tr>
                        <td>Total</td>
                        <td id ="amount"></td>

                    </tr>
                </table>

            </div>

            <li><button type="button" onclick="rediredtToOrder()" >Buy Now</button> </li>



        </div>
        <!------------ Footer ------------->
        <div class="footer">
            <div class="Brands">
                <div class="container">
                    <div class="row">
                        <div class="footer-col-1">
                            <h3>Download Our App</h3>
                            <p>Download App For Android And ios Mobile Phone.</p>
                        </div>
                        <div class="footer-col-2">
                            <img src="https://i.pinimg.com/564x/fd/83/c5/fd83c5d3c62594a851ecd31abf1109b9.jpg">
                            <p>Our Purpose Is To Sustainably Make The Pleasure And Benifits Of Buying and renting The Products To the
                                many.</p>
                        </div>
                        <div class="footer-col-3">
                            <h3>Useful Links</h3>
                            <ul>
                                <li>Coupons</li>
                                <li>Blog Post</li>
                                <li>Return Policy</li>
                                <li>Join Affiliate</li>
                            </ul>
                        </div>
                        <div class="footer-col-4">
                            <h3>Follow Us</h3>
                            <ul>
                                <li>Facebook</li>
                                <li>Twitter</li>
                                <li>Instagram</li>
                                <li>YouTube</li>
                            </ul>
                        </div>
                    </div>
                    <hr>

                </div>

            </div>
            <!------------js for toggle menu------------->

        </div>

        <!------------js for product gallery-------->
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>

        <script type="text/javascript">
                window.onload = loadData(); 
                function loadData() {
                    
                   updateCartDetail();
                }
                function updateCartDetail()
                {
                    var userData = new Object();
                    userData.uName = "somani@gmail.com";

                    userData.command = "FetchCart";

                    $.ajax({
                        type: "POST",
                        url: "http://localhost:8080/eClothShop/CartItems",
                        data: JSON.stringify(userData),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (response) {
                            buildTable(response);
                            //                                   $.each(response, function () {

//                                        $.each(this, function (key, value) {
//                                            alert(key);
//                                            alert(value);
//                                        });
                            //                                   });

                        },
                        failure: function (response) {
                            alert(response.message);
                            //  location.href = "regmodal.html";
                        }
                    });
//                            alert(localStorage.getItem('cartData'));
//                            var productsSelected = JSON.parse(localStorage.getItem('cartData'));
//                            alert(productsSelected);
                    // buildTable(productsSelected);
                }
                function OnSuccess(response) {

                    alert(response.message());
                    buildTable(response);
                }

                function buildTable(prdts) {
                    console.log("build table function called", prdts);
                    var table = document.getElementById('myTable');
                    //var prdts = data['products'];
                    var noOfrows = prdts.length;
                    var rowindex = 0;
                    var startIndex = 0;
                    var tr;
                    var table = document.getElementById('myTable');
                    var subtotalAmount = 0;
                    for (var i = 0; i < prdts.length; i++) {
                        tr = document.createElement('tr');
                        // for (var j = 1; j <= 3; j++) {



                        var td1 = document.createElement('td');
                        var td2 = document.createElement('td');
                        var td3 = document.createElement('td');
                        var td4 = document.createElement('td');
                        var td5 = document.createElement('td');
                        var tdd = prdts[rowindex].source;
                        var img = document.createElement('img');
                        img.src = tdd;
                        //document.getElementById('body').appendChild(img);
                        //var text1 = document.
                        var text2 = document.createTextNode(prdts[rowindex].quantity);
                        var totalprice = prdts[rowindex].quantity * prdts[rowindex].price;
                        subtotalAmount = subtotalAmount + totalprice;
                        var text3 = document.createTextNode(totalprice);
                        var size = document.createTextNode(prdts[rowindex].size);
                        var remvBtn = document.createElement('button');
                        remvBtn.innerHTML = "REMOVE";
                        remvBtn.onclick = function ()
                        {
                            
                            removeFromCart();
                        }

                        td1.appendChild(img);
                        td2.appendChild(text2);
                        td3.appendChild(text3);
                        td4.appendChild(remvBtn);
                        tr.appendChild(td1);
                        tr.appendChild(td2);
                        tr.appendChild(size);
                        tr.appendChild(td3);
                        tr.appendChild(td4);


                        //table.appendChild(tr);
                        //    }
                        table.appendChild(tr);



//                                var tdata = prdts['source'];
//                                var row = '<tr><td>${}</td> <td>prdts[quantity]</td><td>${prdts[price]}</td></tr>';
//                                table.innerHTML += row;
                        rowindex++;

                    }
                    document.getElementById('amount').innerHTML = subtotalAmount;
                }

                function rediredtToOrder()
                {
                    window.location.href = "orderdetailspage.html";
                }
                function removeFromCart()
                {
                    
                }
        </script>
    </body>

</html>